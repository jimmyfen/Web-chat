webpackJsonp([1],{"+BTi":function(t,n){},GXEp:function(t,n){},H3rH:function(t,n){},Iun5:function(t,n){},Jutj:function(t,n){},NHnr:function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0});e("Iun5"),e("+BTi");var s=e("ttjG"),i=e.n(s),a=(e("jAzQ"),e("wOhx")),o=e.n(a),c=(e("GXEp"),e("mtrD")),r=e.n(c),l=(e("X+ky"),e("HJMx")),u=e.n(l),h=(e("NOFV"),e("mWcH")),m=e.n(h),d=(e("w2s5"),e("oTyR")),p=e.n(d),g=(e("ZzA9"),e("cgIP")),v=e.n(g),f=(e("H3rH"),e("6mNG")),_=e.n(f),w=e("7+uW"),C={render:function(){var t=this.$createElement;return(this._self._c||t)("router-view")},staticRenderFns:[]};var b=e("VU/8")({name:"App"},C,!1,function(t){e("cBRi")},null,null).exports,j=e("/ocq"),k=e("mvHQ"),I=e.n(k);function y(t){this.vue=t;var n=sessionStorage.getItem("name"),e="wss://chat.fzhang.cn/ws";e=n?e+"?name="+n:e,this.ws=new WebSocket(e),this.ws.onopen=this.open,this.ws.onclose=this.close,this.ws.onmessage=this.message.bind(this)}y.prototype={open:function(){},close:function(){},message:function(t){var n=JSON.parse(t.data);if("INIT"===n.command&&(this.vue.fd=n.content.fds,this.vue.list=n.content.list,this.vue.total=this.vue.fd.length,this.vue.name=n.content.name,sessionStorage.setItem("name",n.content.name),sessionStorage.setItem("fd",n.content.fd),this.vue.messageList.push({position:"middle",content:"你 加入了群聊"}),this.vue.scrollToBottom()),"ADD_USER"===n.command&&(this.vue.fd.push(n.content.fd),this.vue.list.push({name:n.content.name}),this.vue.total=this.vue.fd.length,this.vue.messageList.push({postion:"middle",content:n.content.name+" 加入了群聊"}),this.vue.scrollToBottom()),"DELETE_USER"===n.command){var e=this.vue.fd.indexOf(n.content.fd);e>-1&&(this.vue.fd.splice(e,1),this.vue.list.splice(e,1)),this.vue.total=this.vue.fd.length,this.vue.messageList.push({position:"middle",content:n.content.name+" 退出了群聊"}),this.vue.scrollToBottom()}if(["MESSAGE","IMOJI","IMAGE"].indexOf(n.command)>-1&&(this.vue.messageList.push({position:"left",name:this.vue.list[n.fd].name,content:n.content}),this.vue.scrollToBottom()),"CHANGE_NAME"===n.command){var s=this.vue.fd.indexOf(n.content.fd);this.vue.list[s].name=n.content.name,this.vue.messageList.push({position:"middle",content:n.content.originName+" 将昵称改为 "+n.content.name}),this.vue.scrollToBottom()}}};var z=y,x={data:function(){var t=navigator.userAgent.toLowerCase();return{name:"",fd:[],list:[],messageList:[],total:0,content:"",showEmoji:!1,isMobile:t.indexOf("iphone")>-1||t.indexOf("ipad")>-1||t.indexOf("android")>-1,showMenu:!1,showImage:!1,imageSrc:"",emojiList:["http://chat.fzhang.cn/statics/emoji/0.png","http://chat.fzhang.cn/statics/emoji/1.png","http://chat.fzhang.cn/statics/emoji/2.png","http://chat.fzhang.cn/statics/emoji/3.png","http://chat.fzhang.cn/statics/emoji/4.png","http://chat.fzhang.cn/statics/emoji/5.png","http://chat.fzhang.cn/statics/emoji/6.png","http://chat.fzhang.cn/statics/emoji/7.png","http://chat.fzhang.cn/statics/emoji/8.png","http://chat.fzhang.cn/statics/emoji/9.png","http://chat.fzhang.cn/statics/emoji/10.png","http://chat.fzhang.cn/statics/emoji/11.png","http://chat.fzhang.cn/statics/emoji/12.png","http://chat.fzhang.cn/statics/emoji/13.png","http://chat.fzhang.cn/statics/emoji/14.png","http://chat.fzhang.cn/statics/emoji/15.png","http://chat.fzhang.cn/statics/emoji/16.png","http://chat.fzhang.cn/statics/emoji/17.png"]}},methods:{show:function(){this.showEmoji=!0},sendEmoji:function(t){var n=sessionStorage.getItem("name");this.socket.ws.send(I()({command:"IMOJI",content:t.target.getAttribute("data-index")})),this.showEmoji=!1,this.messageList.push({position:"right",name:n,content:'<img src="'+t.target.src+'" />'}),this.scrollToBottom()},sendImage:function(t){var n=t.target,e=n.files[0],s=new FileReader,i=sessionStorage.getItem("name");s.readAsDataURL(e),s.onload=function(){var t={command:"IMAGE",content:'<img src="'+s.result+'" />'};this.socket.ws.send(I()(t)),n.value="",this.messageList.push({position:"right",name:i,content:t.content}),this.scrollToBottom()}.bind(this)},sendMessage:function(t){if(t.preventDefault(),""!==this.content){var n=sessionStorage.getItem("name");this.socket.ws.send(I()({command:"MESSAGE",content:this.content})),this.messageList.push({position:"right",name:n,content:this.content}),this.content="",this.scrollToBottom()}},sendName:function(t){var n=parseInt(sessionStorage.getItem("fd")),e=this.fd.indexOf(n);this.socket.ws.send(I()({command:"CHANGE_NAME",content:this.name})),this.messageList.push({position:"middle",content:"你 将昵称改为 "+this.name}),this.list[e].name=this.name,sessionStorage.setItem("name",this.name),this.scrollToBottom()},blur:function(t){t.target.blur()},showMenuF:function(t){this.showMenu=!this.showMenu},showBigImage:function(t){"img"===t.target.tagName.toLowerCase()&&(this.imageSrc=t.target.src,this.showImage=!this.showImage)},scrollToBottom:function(){setTimeout(function(){var t=document.querySelector(".chat-box");t.scrollTo(0,t.scrollHeight)},500)}},mounted:function(){this.socket=new z(this),document.addEventListener("click",function(){this.showEmoji=!1,this.showMenu=!1,this.showImage=!1}.bind(this))}},E={render:function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("div",{staticClass:"scroll",attrs:{id:"app"}},[t.isMobile?[e("el-container",[e("el-header",{attrs:{height:"5vh"}},[e("i",{staticClass:"el-icon-menu",on:{click:function(n){return n.stopPropagation(),t.showMenuF(n)}}}),t._v("  聊天窗口\n            ")]),t._v(" "),t.showMenu?e("div",{staticClass:"list"},[e("el-input",{attrs:{placeholder:"请输入昵称",size:"mini"},on:{blur:function(n){return n.preventDefault(),t.sendName(n)}},nativeOn:{click:function(t){t.stopPropagation()},keyup:function(n){return"button"in n||13===n.keyCode?(n.preventDefault(),t.blur(n)):null}},model:{value:t.name,callback:function(n){t.name=n},expression:"name"}},[e("template",{slot:"prepend"},[t._v("昵称")])],2),t._v(" "),e("div",{staticClass:"line bg-head"},[t._v("在线人数："+t._s(t.total))]),t._v(" "),e("div",{staticClass:"scroll",staticStyle:{"max-height":"30vh"}},t._l(t.list,function(n){return e("div",{staticClass:"line bg-body"},[t._v(t._s(n.name))])}))],1):t._e(),t._v(" "),e("el-main",[e("div",{staticClass:"chat-box scroll"},[t._l(t.messageList,function(n){return["left"===n.position?e("div",{staticClass:"chat-item"},[e("div",{staticClass:"name"},[t._v(t._s(n.name))]),t._v(" "),e("div",{staticClass:"content",domProps:{innerHTML:t._s(n.content)},on:{click:function(n){return n.stopPropagation(),t.showBigImage(n)}}})]):"right"===n.position?e("div",{staticClass:"chat-item right"},[e("div",{staticClass:"name"},[t._v(t._s(n.name))]),t._v(" "),e("div",{staticClass:"content",domProps:{innerHTML:t._s(n.content)},on:{click:function(n){return n.stopPropagation(),t.showBigImage(n)}}})]):e("div",{staticClass:"middle"},[e("span",{staticClass:"tips"},[t._v(t._s(n.content))])]),t._v(" "),e("div",{staticClass:"clear"})]})],2),t._v(" "),e("div",{staticClass:"toolbar"},[e("div",{staticClass:"icon"},[e("img",{attrs:{src:"http://chat.fzhang.cn/statics/emoji/0.png"},on:{click:function(n){return n.stopPropagation(),t.show(n)}}}),t._v(" "),t.showEmoji?e("div",{staticClass:"img-list"},t._l(t.emojiList,function(n,s){return e("img",{attrs:{src:n,"data-index":s},on:{click:function(n){return n.stopPropagation(),t.sendEmoji(n)}}})})):t._e()]),t._v(" "),e("div",{staticClass:"icon file"},[e("input",{attrs:{type:"file"},on:{change:t.sendImage}}),t._v(" "),e("img",{attrs:{src:"http://chat.fzhang.cn/statics/emoji/pic.png"}})]),t._v(" "),e("div",{staticClass:"clear"})]),t._v(" "),e("el-input",{attrs:{type:"textarea",placeholder:"请输入内容",autosize:!0},nativeOn:{keydown:function(t){if(!("button"in t)&&13!==t.keyCode)return null;t.preventDefault()},keyup:function(n){return"button"in n||13===n.keyCode?(n.preventDefault(),t.sendMessage(n)):null}},model:{value:t.content,callback:function(n){t.content=n},expression:"content"}}),t._v(" "),e("div",{staticStyle:{position:"relative",height:"5vh","background-color":"#fff"}},[e("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(n){return n.stopPropagation(),t.sendMessage(n)}}},[t._v("发送")])],1)],1)],1),t._v(" "),t.showImage?e("div",{staticClass:"big-img"},[e("img",{attrs:{src:t.imageSrc}})]):t._e()]:[e("el-container",[e("el-header",[t._v("\n                欢迎来到聊天室\n            ")])],1),t._v(" "),e("el-container",[e("el-aside",{attrs:{width:"200px"}},[e("div",[e("el-input",{attrs:{placeholder:"请输入昵称"},on:{blur:function(n){return n.stopPropagation(),n.preventDefault(),t.sendName(n)}},nativeOn:{keyup:function(n){return"button"in n||13===n.keyCode?(n.preventDefault(),t.blur(n)):null}},model:{value:t.name,callback:function(n){t.name=n},expression:"name"}},[e("template",{slot:"prepend"},[t._v("昵称")])],2)],1),t._v(" "),e("div",{staticClass:"line bg-head"},[t._v("在线人数："+t._s(t.total))]),t._v(" "),e("div",{staticClass:"scroll",staticStyle:{"max-height":"500px"}},t._l(t.list,function(n){return e("div",{staticClass:"line bg-body"},[t._v(t._s(n.name))])}))]),t._v(" "),e("el-container",[e("el-header",{attrs:{height:"50px"}},[t._v("聊天窗口")]),t._v(" "),e("el-main",[e("div",{staticClass:"chat-box scroll"},[t._l(t.messageList,function(n){return["left"===n.position?e("div",{staticClass:"chat-item"},[e("div",{staticClass:"name"},[t._v(t._s(n.name))]),t._v(" "),e("div",{staticClass:"content",domProps:{innerHTML:t._s(n.content)},on:{click:function(n){return n.stopPropagation(),t.showBigImage(n)}}})]):"right"===n.position?e("div",{staticClass:"chat-item right"},[e("div",{staticClass:"name"},[t._v(t._s(n.name))]),t._v(" "),e("div",{staticClass:"content",domProps:{innerHTML:t._s(n.content)},on:{click:function(n){return n.stopPropagation(),t.showBigImage(n)}}})]):e("div",{staticClass:"middle"},[e("span",{staticClass:"tips"},[t._v(t._s(n.content))])]),t._v(" "),e("div",{staticClass:"clear"})]})],2),t._v(" "),e("div",{staticClass:"toolbar"},[e("div",{staticClass:"icon"},[e("img",{attrs:{src:"http://chat.fzhang.cn/statics/emoji/0.png"},on:{click:function(n){return n.stopPropagation(),t.show(n)}}}),t._v(" "),t.showEmoji?e("div",{staticClass:"img-list"},t._l(t.emojiList,function(n,s){return e("img",{attrs:{src:n,"data-index":s},on:{click:function(n){return n.stopPropagation(),t.sendEmoji(n)}}})})):t._e()]),t._v(" "),e("div",{staticClass:"icon file"},[e("input",{attrs:{type:"file"},on:{change:t.sendImage}}),t._v(" "),e("img",{attrs:{src:"http://chat.fzhang.cn/statics/emoji/pic.png"}})]),t._v(" "),e("div",{staticClass:"clear"})]),t._v(" "),e("el-input",{attrs:{type:"textarea",placeholder:"请输入内容",autosize:!0},nativeOn:{keydown:function(t){if(!("button"in t)&&13!==t.keyCode)return null;t.preventDefault()},keyup:function(n){return"button"in n||13===n.keyCode?(n.preventDefault(),t.sendMessage(n)):null}},model:{value:t.content,callback:function(n){t.content=n},expression:"content"}}),t._v(" "),e("div",{staticStyle:{position:"relative",border:"1px solid #dcdfe6",height:"28px","border-top":"none"}},[e("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(n){return n.stopPropagation(),t.sendMessage(n)}}},[t._v("发送")])],1)],1)],1)],1),t._v(" "),t.showImage?e("div",{staticClass:"big-img"},[e("img",{attrs:{src:t.imageSrc}})]):t._e()]],2)},staticRenderFns:[]};var M=e("VU/8")(x,E,!1,function(t){e("Jutj")},null,null).exports;w.default.use(j.a);var S=new j.a({routes:[{path:"/",name:"index",component:M}]});e("tvR6");w.default.use(_.a),w.default.use(v.a),w.default.use(p.a),w.default.use(m.a),w.default.use(u.a),w.default.use(r.a),w.default.use(o.a),w.default.use(i.a),w.default.config.productionTip=!1,new w.default({el:"#app",router:S,components:{App:b},template:"<App/>"})},NOFV:function(t,n){},"X+ky":function(t,n){},ZzA9:function(t,n){},cBRi:function(t,n){},jAzQ:function(t,n){},tvR6:function(t,n){},w2s5:function(t,n){}},["NHnr"]);